scale_colour_discrete("MFA status") +
# set axis labels
xlab("Date") +
ylab("NHSmail accounts") +
ggtitle("The uptake of NHSmail multi factor authentication at Dorset HealthCare") +
# set theme
theme_base() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 11),
plot.caption = element_text(size = 8),
legend.text = element_text(size = 12),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 8),
strip.text.y = element_text(size = 9.5))
df_plot
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_mfagrp2 <- df %>%
count(MFAStatus)
# Remove new mailboxes with blank status
df_mfagrp2 <- df_mfagrp2[!(df_mfagrp2$MFAStatus==""), ]
View(df_mfagrp2)
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_mfagrp2 <- df %>%
count(MFAStatus)
# Remove new mailboxes with blank status
df_mfagrp2 <- df_mfagrp2[!(df_mfagrp2$MFAStatus==""), ]
View(df_mfagrp2)
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate,
ggthemes,
ggtext
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file(timeseriesloc))
# define the date format
df$date = as.Date(df$date, "%Y-%m-%d")
# create the plot
df_plot <- ggplot() +
# plot line data
geom_line(data = df, aes(x = date, y = n, group = MFAStatus, colour = MFAStatus), size = 2) +
# set scales
scale_x_date(date_labels = "%d %b %y") +
scale_colour_discrete("MFA status") +
# set axis labels
xlab("Date") +
ylab("NHSmail accounts") +
ggtitle("The uptake of NHSmail multi factor authentication at Dorset HealthCare") +
# set theme
theme_base() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 11),
plot.caption = element_text(size = 8),
legend.text = element_text(size = 12),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 8),
strip.text.y = element_text(size = 9.5))
df_plot
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_mfagrp2 <- df %>%
count(MFAStatus)
# Remove new mailboxes with blank status
df_mfagrp2 <- df_mfagrp2[!(df_mfagrp2$MFAStatus==""), ]
# Set today's date
date_import <- today()
# Add a new column named 'date' and populate it with the value of date_import
df_mfagrp2['date']= date_import
View(df_mfagrp2)
# set working directory where the mailbox report can be found
setwd("c:/b")
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
View(df)
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_mfagrp2 <- df %>%
count(User.Policy.Name)
View(df_mfagrp2)
rm(df_mfagrp2)
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_policy <- df %>%
count(User.Policy.Name)
dfo <- read.csv(file("Mailbox Report 08.07.22.csv"))
# Filter only active user mailboxes
dfo <- dfo %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
dfo_policy <- dfo %>%
count(User.Policy.Name)
View(df_policy)
rename(dfo_policy$n = "08.07.22")
names(df_policy)[names(df_policy) == "n"] <- "29.07.22"
names(dfo_policy)[names(dfo_policy) == "n"] <- "08.07.22"
dfm <- merge(df_policy,dfo_policy,by="User.Policy.Name")
View(dfm)
View(dfo_policy)
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_mfagrp2 <- df %>%
count(MFAStatus)
View(df_mfagrp2)
# Remove new mailboxes with blank status
df_mfagrp2 <- df_mfagrp2[!(df_mfagrp2$MFAStatus==""), ]
# Set today's date
date_import <- today()
# Add a new column named 'date' and populate it with the value of date_import
df_mfagrp2['date']= date_import
if (!file.exists(timeseriesloc)) {
write.csv(df_mfagrp2, file = timeseriesloc, row.names = FALSE)
} else {
# Import existing data
df_previous <- read.csv(file = timeseriesloc)
# Merge the two datasets
df_merged <- rbind(df_mfagrp2, df_previous)
# Save the resulting dataset back to the monthly file
write.csv(df_merged, file = timeseriesloc, row.names = FALSE)
}
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate,
ggthemes,
ggtext
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file(timeseriesloc))
# define the date format
df$date = as.Date(df$date, "%Y-%m-%d")
# create the plot
df_plot <- ggplot() +
# plot line data
geom_line(data = df, aes(x = date, y = n, group = MFAStatus, colour = MFAStatus), size = 2) +
# set scales
scale_x_date(date_labels = "%d %b %y") +
scale_colour_discrete("MFA status") +
# set axis labels
xlab("Date") +
ylab("NHSmail accounts") +
ggtitle("The uptake of NHSmail multi factor authentication at Dorset HealthCare") +
# set theme
theme_base() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 11),
plot.caption = element_text(size = 8),
legend.text = element_text(size = 12),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 8),
strip.text.y = element_text(size = 9.5))
df_plot
# set working directory where the mailbox report can be found
setwd("c:/b")
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
dfo <- read.csv(file("Mailbox Report 08.07.22.csv"))
# Filter only active user mailboxes
dfo <- dfo %>%
filter(Status == "Active" & MailboxType == "User")
View(df)
df2 <- subset(df, select = c("EmailAddress", "User.Policy.Name", "MFAStatus"))
dfo2 <- subset(dfo, select = c("EmailAddress", "User.Policy.Name", "MFAStatus"))
View(df2)
names(dfo2)[names(dfo2) == "MFAStatus"] <- "MFAStatus08.07.22"
View(dfo2)
names(df2)[names(df2) == "MFAStatus"] <- "MFAStatus29.07.22"
names(dfo2)[names(dfo2) == "User.Policy.Name"] <- "Policy08.07.22"
names(dfo2)[names(dfo2) == "User.Policy.Name"] <- "Policy29.07.22"
names(df2)[names(df2) == "User.Policy.Name"] <- "Policy29.07.22"
dfm <- merge(df2,dfo2,by="EmailAddress")
View(dfm)
write.csv(dfm, compare.csv)
write.csv(dfm, "compare.csv")
write.csv(dfm, "compare.csv", row.names = FALSE)
dfm$PolicyMatch <- identical(dfm$Policy08.07.22, dfm$Policy29.07.22)
View(dfm)
rm(dfm$PolicyMatch)
rm(dfm)
dfm <- merge(df2,dfo2,by="EmailAddress")
dfm$PolicyMatch <- dfm$Policy08.07.22 == dfm$Policy29.07.22
View(dfm)
dfm$StatusMatch <- dfm$MFAStatus08.07.22 == dfm$MFAStatus29.07.22
write.csv(dfm, "compare.csv", row.names = FALSE)
write.csv(dfm, "compare.csv", row.names = FALSE)
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_mfagrp2 <- df %>%
count(MFAStatus)
# Remove new mailboxes with blank status
df_mfagrp2 <- df_mfagrp2[!(df_mfagrp2$MFAStatus==""), ]
# Set today's date
date_import <- today()
# Add a new column named 'date' and populate it with the value of date_import
df_mfagrp2['date']= date_import
if (!file.exists(timeseriesloc)) {
write.csv(df_mfagrp2, file = timeseriesloc, row.names = FALSE)
} else {
# Import existing data
df_previous <- read.csv(file = timeseriesloc)
# Merge the two datasets
df_merged <- rbind(df_mfagrp2, df_previous)
# Save the resulting dataset back to the monthly file
write.csv(df_merged, file = timeseriesloc, row.names = FALSE)
}
View(df_mfagrp2)
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate,
ggthemes,
ggtext
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file(timeseriesloc))
# define the date format
df$date = as.Date(df$date, "%Y-%m-%d")
# create the plot
df_plot <- ggplot() +
# plot line data
geom_line(data = df, aes(x = date, y = n, group = MFAStatus, colour = MFAStatus), size = 2) +
# set scales
scale_x_date(date_labels = "%d %b %y") +
scale_colour_discrete("MFA status") +
# set axis labels
xlab("Date") +
ylab("NHSmail accounts") +
ggtitle("The uptake of NHSmail multi factor authentication at Dorset HealthCare") +
# set theme
theme_base() +
theme(
axis.text.x = element_text(size = 8),
axis.text.y = element_text(size = 8),
plot.title = element_text(size = 20, family = "Helvetica", face = "bold"),
plot.subtitle = element_markdown(hjust = 0, vjust = 0, size = 11),
plot.caption = element_text(size = 8),
legend.text = element_text(size = 12),
legend.background = element_blank(),
legend.box.background = element_rect(colour = "black"),
axis.title = element_text(size = 12),
axis.text = element_text(size = 8),
strip.text.y = element_text(size = 9.5))
df_plot
dfo <- read.csv(file("Mailbox Report 08.07.22.csv"))
# Filter only active user mailboxes
dfo <- dfo %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
dfo_policy <- dfo %>%
count(User.Policy.Name)
# set working directory where the mailbox report can be found
setwd("c:/b")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("Mailbox Report.csv"))
# Filter only active user mailboxes
df <- df %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
df_mfagrp2 <- df %>%
count(MFAStatus)
# Remove new mailboxes with blank status
df_mfagrp2 <- df_mfagrp2[!(df_mfagrp2$MFAStatus==""), ]
# Set today's date
date_import <- today()
# Add a new column named 'date' and populate it with the value of date_import
df_mfagrp2['date']= date_import
dfo <- read.csv(file("Mailbox Report 08.07.22.csv"))
# Filter only active user mailboxes
dfo <- dfo %>%
filter(Status == "Active" & MailboxType == "User")
# Create a second dataframe to count occurrences of the text in
# the MFAStatus column in the mailbox report
dfo_policy <- dfo %>%
count(User.Policy.Name)
names(dfo_policy)[names(dfo_policy) == "n"] <- "08.07.22"
df2 <- subset(df, select = c("EmailAddress", "User.Policy.Name", "MFAStatus"))
dfo2 <- subset(dfo, select = c("EmailAddress", "User.Policy.Name", "MFAStatus"))
names(dfo2)[names(dfo2) == "User.Policy.Name"] <- "Policy08.07.22"
names(df2)[names(df2) == "User.Policy.Name"] <- "Policy19.08.22"
names(df2)[names(df2) == "MFAStatus"] <- "MFAStatus19.08.22"
dfm <- merge(df2,dfo2,by="EmailAddress")
dfm$PolicyMatch <- dfm$Policy08.07.22 == dfm$Policy29.07.22
dfm$StatusMatch <- dfm$MFAStatus08.07.22 == dfm$MFAStatus29.07.22
write.csv(dfm, "compare2.csv", row.names = FALSE)
dfm$PolicyMatch <- dfm$Policy08.07.22 == dfm$Policy19.08.22
dfm$StatusMatch <- dfm$MFAStatus08.07.22 == dfm$MFAStatus19.08.22
write.csv(dfm, "compare2.csv", row.names = FALSE)
View(dfm)
dfm$StatusMatch <- dfm$MFAStatus == dfm$MFAStatus19.08.22
write.csv(dfm, "compare2.csv", row.names = FALSE)
# set working directory where the mailbox report can be found
setwd("c:/github/nhsmail-scripts")
# set file path where you want to keep time series data as a CSV
# you may want this to be somewhere that gets backed up
timeseriesloc <- "j:/MFAstatusTimeSeries2.csv"
# Install the pacman package to call all the other packages
if (!require("pacman")) install.packages("pacman")
# Use pacman to install (if req) and load required packages
pacman::p_load(
tidyverse,
zoo,
data.table,
utils,
lubridate
)
# Import the NHSmail mailbox report from your working directory
df <- read.csv(file("data/Mailbox Report.csv"))
rm(df)
# Import the NHSmail mailbox report from your data sub-directory
df_mbr <- read.csv(file("data/Mailbox Report.csv"))
# Import the NHSmail MFA status report from your data sub-directory
df_mfr <- read.csv(file("data/MFAStatusReport.csv"))
# Filter mailbox report for active user mailboxes
df_mbr <- df_mbr %>%
filter(Status == "Active" & MailboxType == "User")
View(df_mbr)
View(df_mfr)
df_work <- subset(df_mbr, select = c("EmailAddress"))
View(df_work)
# get the MSOA code from the LSOA/MSOA lookup table
df_work$MFAStatus <- with(df_mfr, MFAStatus[match(df_work$EmailAddress, EmailAddress)])
View(df_work)
write.csv(df_work, file = "stats.csv")
